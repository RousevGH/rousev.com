<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Whole Domain</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

:root {
    --accent:#596BFF;
    --bg-light:#f7f7fa;
    --bg-dark:#0F1116;
    --text-light:#111;
    --text-dark:#eee;
    --post-l1:#ffffff60;
    --post-l2:#00000010;
    --post-d1:#1c1f27;
    --post-d2:#080a0f;
}

*{margin:0;padding:0;box-sizing:border-box;}
body{
    font-family:Inter,sans-serif;
    background:var(--bg-light);
    color:var(--text-light);
    padding-top:70px;
    transition:.35s;
}
body.dark{background:var(--bg-dark);color:var(--text-dark);}

.top{
    position:fixed;inset:0 auto auto 0;height:60px;
    display:flex;justify-content:space-between;align-items:center;
    padding:0 18px;backdrop-filter:blur(16px);z-index:50;
}

.icon{
    width:24px;height:24px;cursor:pointer;
    fill:currentColor;transition:.22s;
}
.icon:hover{color:var(--accent);transform:scale(1.12);}

.sort-menu{
    position:absolute;top:38px;right:0;display:none;
    background:inherit;border-radius:10px;padding:8px 0;
    backdrop-filter:blur(14px);width:160px;
}
.sort-menu.show{display:block;}
.sort-option{
    padding:10px 14px;cursor:pointer;display:flex;gap:10px;align-items:center;
}
.sort-option:hover{background:rgba(255,255,255,.12);}

.container{max-width:900px;margin:0 auto;padding:30px 18px;}

.post{
    padding:25px;margin-bottom:26px;border-radius:14px;
    background:linear-gradient(to bottom,var(--post-l1),var(--post-l2));
    cursor:pointer;transition:.25s;
}
body.dark .post{
    background:linear-gradient(to bottom,var(--post-d1),var(--post-d2));
}
.post:hover{
    transform:translateY(-4px) scale(1.03);
    box-shadow:0 12px 36px rgba(0,0,0,.32);
}

.post.pinned{
    border:2px solid var(--accent);
    box-shadow:0 0 18px rgba(89,107,255,.45);
}

.tags{display:flex;gap:8px;margin-bottom:6px;flex-wrap:wrap;}
.tag{
    background:var(--accent);color:#fff;
    padding:3px 9px;border-radius:6px;font-size:12px;
    transition:.2s;
}
.tag:hover{transform:scale(1.1);}

.post img{
    width:150px;height:150px;border-radius:10px;
    object-fit:cover;float:right;margin-left:10px;
}

.post-title{font-size:22px;font-weight:600;margin-bottom:10px;}
.date{opacity:.65;font-size:13px;margin-top:10px;}

.fullscreen{
    position:fixed;inset:0;
    display:none;justify-content:center;
    background:rgba(0,0,0,.55);backdrop-filter:blur(12px);
    z-index:100;padding:30px;
}
.fullscreen-inner{
    background:inherit;padding:35px 26px;
    max-width:800px;width:100%;border-radius:16px;
    animation:fadePop .35s cubic-bezier(.16,1,.3,1);
}
@keyframes fadePop{
    0%{transform:scale(.8) translateY(20px);opacity:0;}
    100%{transform:scale(1) translateY(0);opacity:1;}
}
.close{
    position:absolute;top:14px;right:20px;
    font-size:30px;cursor:pointer;opacity:.65;
}
.close:hover{opacity:1;}

@media(max-width:800px){
    .post img{width:100%;height:200px;margin:0 0 10px;float:none;}
}
</style>
</head>

<body>

<div class="top">
    <div style="font-size:18px;font-weight:600;">
        I bought the whole domain, I'm going to use the whole domain
    </div>

    <div style="display:flex;gap:16px;align-items:center;">

        <div style="position:relative;">
            <svg id="sortBtn" class="icon" viewBox="0 0 24 24">
                <path d="M3 6h18v2H3V6zm4 5h14v2H7v-2zm6 5h8v2h-8v-2z"/>
            </svg>
            <div class="sort-menu" id="sortMenu">
                <div class="sort-option" data-sort="date">üïì Newest First</div>
                <div class="sort-option" data-sort="random">üé≤ Shuffle</div>
                <div class="sort-option" data-sort="length">üìè Length</div>
                <div class="sort-option" data-sort="tag">üè∑Ô∏è Tag</div>
            </div>
        </div>

        <svg id="discord" class="icon" viewBox="0 0 24 24">
            <path d="M20 4s-2-1-5-1l-.5 1.3..." />
        </svg>

        <svg id="themeToggle" class="icon" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 10 10A7 7 0 0 1 12 2z"/>
        </svg>

    </div>
</div>

<div class="container"><div id="posts"></div></div>

<div id="modal" class="fullscreen">
    <div id="modalContent" class="fullscreen-inner"></div>
    <div class="close" onclick="closeModal()">√ó</div>
</div>

<script>
let posts = [];
let sortMode = "date";

sortBtn.onclick=()=>sortMenu.classList.toggle("show");
themeToggle.onclick=()=>document.body.classList.toggle("dark");

async function load(){
    let pinned=null;
    try{
        let r=await fetch("Posts/IMPORTANT.txt");
        if(r.ok) pinned={content:await r.text(),pinned:true};
    }catch{}

    let i=1;
    while(true){
        let r=await fetch(`Posts/Thing_${i}.txt`);
        if(!r.ok) break;
        posts.push({content:await r.text()});
        i++;
    }

    if(pinned) posts.unshift(pinned);
    applySort();
}

function parseDate(t){
    let m=t.match(/\\[(\\d{2})\\.(\\d{2})\\.(\\d{4})\\]/);
    if(!m) return new Date(0);
    return new Date(+m[3],+m[2]-1,+m[1]);
}

function cleanTitle(l){
    return l.replace(/\\[\\$\\/.*?\\/\\]/g,"").replace(/\\/#[^\\/]+\\//g,"").trim();
}
function extractTags(l){
    return (l.match(/\\/#[^\\/]+\\//g)||[]).map(x=>x.replace(/[\\/#]/g,""));
}

function applySort(){
    if(sortMode==="date") posts.sort((a,b)=>parseDate(b.content)-parseDate(a.content));
    if(sortMode==="random") posts.sort(()=>Math.random()-.5);
    if(sortMode==="length") posts.sort((a,b)=>b.content.length-a.content.length);
    renderPosts();
}

function renderPosts(){
    let wrap=document.getElementById("posts");
    wrap.innerHTML="";

    posts.forEach(p=>{
        let l=p.content.split("\\n");
        let title=cleanTitle(l[0]);
        let tags=extractTags(l[0]);
        let img=(l[0].match(/\\[\\$\\/url:(.*?)\\/\\]/)||[])[1];
        let body=l.slice(1).join("\\n");
        let date=parseDate(p.content).toLocaleDateString();

        let c=document.createElement("div");
        c.className="post";
        if(p.pinned) c.classList.add("pinned");
        c.innerHTML=`
            ${img?`<img src="${img}">`:""}
            <div class='post-title'>${title}</div>
            <div class='tags'>${tags.map(t=>`<div class="tag">${t}</div>`).join("")}</div>
            <div class='date'>${date}</div>`;
        c.onclick=()=>openModal(title,body,date);
        wrap.appendChild(c);
    });
}

function openModal(t,b,d){
    modalContent.innerHTML=
        `<h2>${t}</h2>
        <div style='white-space:pre-wrap;margin-top:12px;font-size:17px;'>${b}</div>
        <div style='margin-top:14px;opacity:.65;'>${d}</div>`;
    modal.style.display="flex";
}

function closeModal(){ modal.style.display="none"; }

document.querySelectorAll(".sort-option").forEach(o=>o.onclick=()=>{
    sortMode=o.dataset.sort;
    applySort();
    sortMenu.classList.remove("show");
});

load();
</script>

</body>
</html>
