<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>I bought the whole domain</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

:root {
    --accent:#596BFF;
    --bg-light:#fafbfc;
    --bg-dark:#0f1116;
    --text-light:#1a1a1a;
    --text-dark:#eaeaea;
    --post-light1:rgba(255,255,255,.6);
    --post-light2:rgba(0,0,0,.08);
    --post-dark1:#1a1e28;
    --post-dark2:#090c10;
}

*{margin:0;padding:0;box-sizing:border-box;}

body{
    font-family:Inter,sans-serif;
    background:var(--bg-light);
    color:var(--text-light);
    padding-top:65px;
    transition:.3s ease;
}
body.dark{
    background:var(--bg-dark);
    color:var(--text-dark);
}

/******** Header ********/
.top{
    position:fixed;top:0;left:0;width:100%;height:60px;
    display:flex;justify-content:space-between;align-items:center;
    padding:0 18px;backdrop-filter:blur(18px);
    z-index:40;
    border-bottom:1px solid rgba(255,255,255,.05);
}

.tools{
    display:flex;
    gap:10px;
    align-items:center;
}

.tool{
    width:28px;
    height:28px;
    display:flex;
    justify-content:center;
    align-items:center;
    cursor:pointer;
    transition:.2s ease;
    color:inherit;
}
.tool:hover{
    color:var(--accent);
    transform:scale(1.12);
}
.tool svg{
    width:22px;
    height:22px;
    fill:currentColor;
}

/******** Posts ********/
.container{
    max-width:920px;
    margin:0 auto;
    padding:30px 20px;
}

.post{
    padding:26px;
    margin-bottom:28px;
    border-radius:14px;
    background:linear-gradient(to bottom,var(--post-light1),var(--post-light2));
    cursor:pointer;
    transition:.25s ease;
}
body.dark .post{
    background:linear-gradient(to bottom,var(--post-dark1),var(--post-dark2));
}
.post:hover{
    transform:translateY(-4px) scale(1.02);
    box-shadow:0 14px 36px rgba(0,0,0,.32);
}
.post.pinned{
    border:2px solid var(--accent);
    box-shadow:0 0 14px rgba(89,107,255,.4);
}
.post img{
    width:160px;height:160px;border-radius:12px;
    float:right;margin-left:16px;object-fit:cover;
}
.post-title{font-size:22px;font-weight:600;margin-bottom:10px;}
.tags{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap;}
.tag{
    background:var(--accent);
    font-size:13px;
    color:#fff;
    padding:4px 9px;
    border-radius:6px;
}
.date{font-size:13px;opacity:.65;margin-top:12px;}

/******** Modal Popup ********/
.fullscreen{
    position:fixed;inset:0;
    background:rgba(0,0,0,.6);
    backdrop-filter:blur(14px);
    display:none;
    justify-content:center;
    align-items:center;
    padding:22px;
    z-index:100;
}
.fullscreen-inner{
    max-width:850px;width:100%;
    background:inherit;
    padding:35px 26px;
    border-radius:14px;
    animation:popup .35s cubic-bezier(.16,1,.3,1);
}
@keyframes popup{
    0%{opacity:0;transform:scale(.8) translateY(20px);}
    100%{opacity:1;transform:scale(1) translateY(0);}
}
.close{
    position:absolute;top:12px;right:18px;
    font-size:30px;cursor:pointer;opacity:.7;
}
.close:hover{opacity:1;}

.no-posts{
    text-align:center;
    padding:100px 0;
    font-size:22px;
    opacity:.7;
}
</style>
</head>

<body>

<div class="top">
    <div style="font-size:18px;font-weight:600;">I bought the whole domain, I'm going to use the whole domain</div>

    <div class="tools" id="tools">
        <!-- Sort -->
        <div class="tool" id="btnSort" title="Sort">
            <svg viewBox="0 0 24 24"><path d="M3 6h18v2H3zm4 5h14v2H7zm6 5h8v2h-8z"/></svg>
        </div>

        <!-- Discord -->
        <div class="tool" id="btnDiscord" title="Discord">
            <svg viewBox="0 0 24 24"><path d="M20 4s-2-1-5-1l-.5 1.3...z"/></svg>
        </div>

        <!-- Theme -->
        <div class="tool" id="btnTheme" title="Toggle Theme">
            <svg viewBox="0 0 24 24"><path d="M12 3a9 9 0 1 0 9 9A7 7 0 0 1 12 3z"/></svg>
        </div>
    </div>
</div>

<div class="container">
    <div id="posts"></div>
    <div id="noPostsMsg" class="no-posts" style="display:none;">no posts</div>
</div>

<div id="modal" class="fullscreen">
    <div class="fullscreen-inner" id="modalContent"></div>
    <div class="close" onclick="closeModal()">Ã—</div>
</div>

<script>
let posts = [];
let sortMode = "date";

btnTheme.onclick = () => document.body.classList.toggle("dark");
btnDiscord.onclick = () => openModal("Contact", "@brousev on discord");
btnSort.onclick = () => cycleSort();

function cycleSort(){
    const modes=["date","length","random"];
    sortMode = modes[(modes.indexOf(sortMode)+1)%modes.length];
    renderAll();
}

async function fetchText(u){
    try{
        const r = await fetch(u,{cache:"no-store"});
        if(!r.ok) return null;
        return await r.text();
    }catch{
        return null;
    }
}

async function loadPosts(){
    // Pinned
    const pin = await fetchText("./posts/IMPORTANT.txt");
    if(pin) posts.push({content:pin,pinned:true});

    // Thing_N loader
    let i=1;
    while(true){
        const txt = await fetchText("./posts/Thing_" + i + ".txt");
        if(!txt) break;
        posts.push({content:txt,pinned:false});
        i++;
    }

    renderAll();
}

function extractDate(s){
    const m = s.match(/\[(\d{2})\.(\d{2})\.(\d{4})\]/);
    return m ? new Date(+m[3],+m[2]-1,+m[1]) : new Date(0);
}

function cleanTitle(l){
    return l.replace(/\[\$\/.*?\/\]/g,"").replace(/#[^\/]+\/?/g,"").trim();
}

function extractTags(l){
    return (l.match(/#[^\/]+\/?/g) || []).map(t=>t.replace(/[\/#]/g,""));
}

function renderAll(){
    const wrap=document.getElementById("posts");
    const empty=document.getElementById("noPostsMsg");
    wrap.innerHTML="";

    if(posts.length===0){
        empty.style.display="block";
        return;
    }
    empty.style.display="none";

    if(sortMode==="date") posts.sort((a,b)=>extractDate(b.content)-extractDate(a.content));
    if(sortMode==="length") posts.sort((a,b)=>b.content.length-a.content.length);
    if(sortMode==="random") posts.sort(()=>Math.random()-.5);

    posts.forEach(p=>{
        const lines=p.content.split("\n");
        const title=cleanTitle(lines[0]);
        const tags=extractTags(lines[0]);
        const img=(lines[0].match(/\[\$\/url:(.*?)\/\]/)||[])[1];
        const body=lines.slice(1).join("\n");
        const date=extractDate(p.content).toLocaleDateString();

        const el=document.createElement("div");
        el.className="post";
        if(p.pinned) el.classList.add("pinned");
        el.innerHTML=`
        ${img?`<img src="${img}">`:""}
        <div class="post-title">${title}</div>
        <div class="tags">${tags.map(t=>`<div class="tag">${t}</div>`).join("")}</div>
        <div class="date">${date}</div>
        `;
        el.onclick=()=>openModal(title,body,date);
        wrap.append(el);
    });
}

function openModal(t,b="",d=""){
    modalContent.innerHTML=`
        <h2>${t}</h2>
        ${b?`<div style='white-space:pre-wrap;margin-top:16px;font-size:17px;'>${b}</div>`:""}
        ${d?`<div style='margin-top:18px;opacity:.65;'>${d}</div>`:""}
    `;
    document.getElementById("modal").style.display="flex";
}
function closeModal(){
    document.getElementById("modal").style.display="none";
}

loadPosts();
</script>

</body>
</html>
