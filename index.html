<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>I bought the whole domain, I’m going to use the whole domain</title>

<style>
:root {
  --accent:#5665ff;
  --accent2:#ff3d5e;
  --light-top:#f6f6fa;
  --light-bottom:#d7d7e3;
  --dark-top:#0c0e15;
  --dark-bottom:#11131b;
  --radius:18px;
}

* {margin:0;padding:0;box-sizing:border-box;font-family:Inter,system-ui,sans-serif;}

body {
  min-height:100vh;
  padding-top:70px;
  background:linear-gradient(to bottom,var(--light-top),var(--light-bottom));
  color:#111;
  transition:.35s;
}

body.dark {
  background:linear-gradient(to bottom,var(--dark-top),var(--dark-bottom));
  color:#eee;
}

header {
  position:fixed;top:0;left:0;right:0;
  height:70px;
  backdrop-filter:blur(14px);
  background:rgba(255,255,255,.75);
  border-bottom:1px solid rgba(0,0,0,.08);
  display:flex;align-items:center;justify-content:space-between;
  padding:0 14px;
  z-index:99;
  transition:.3s;
}
body.dark header {
  background:rgba(0,0,0,.45);
}
.hide-header {transform:translateY(-100%);}

#title {
  font-weight:700;
  font-size:17px;
  opacity:.9;
  user-select:none;
}

#icons {
  display:flex;
  gap:8px;
}

.icon-btn {
  width:38px;height:38px;
  border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  background:rgba(255,255,255,.2);
  transition:.25s;
}
body.dark .icon-btn {background:rgba(0,0,0,.3);}
.icon-btn:hover {
  background:var(--accent);
  color:white;
}

.icon-btn svg {width:22px;height:22px;fill:currentColor;}

.container {
  max-width:900px;
  margin:0 auto;
  padding:18px;
}

/* POST CARD */
.post {
  background:linear-gradient(to bottom,rgba(255,255,255,.15),rgba(255,255,255,.04));
  border-radius:var(--radius);
  padding:24px;
  margin-bottom:24px;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
  transform:translateX(-22px) translateY(16px) scale(.97);
  opacity:0;
  transition:transform .6s cubic-bezier(.18,.55,.27,1),opacity .6s;
  will-change:transform;
  perspective:800px;
  cursor:pointer;
}
body.dark .post {
  background:linear-gradient(to bottom,rgba(255,255,255,.07),rgba(0,0,0,.15));
}
.post.visible {
  transform:translateX(0) translateY(0) scale(1);
  opacity:1;
}
.post:hover {
  box-shadow:0 10px 26px rgba(0,0,0,.12);
}

.post-title {
  font-size:20px;
  font-weight:600;
  margin-bottom:10px;
}

.post-tags {
  margin-top:6px;
  display:flex;
  gap:6px;
  flex-wrap:wrap;
}
.tag {
  background:var(--accent2);
  color:#fff;
  border-radius:10px;
  padding:2px 8px;
  font-size:12px;
  cursor:pointer;
}
.tag:hover {
  opacity:.8;
}

/* DATE */
.date {
  font-size:13px;
  opacity:.7;
  margin-top:10px;
  font-style:italic;
}

/* FULLSCREEN MODAL */
.modal {
  position:fixed;top:0;left:0;width:100%;height:100%;
  display:none;
  align-items:center;justify-content:center;
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(10px);
  z-index:999;
}
.modal.show {display:flex;}

.modal-inner {
  background:linear-gradient(to bottom,var(--light-top),var(--light-bottom));
  color:#000;
  padding:32px;
  border-radius:var(--radius);
  max-width:700px;
  width:90%;
  max-height:85vh;
  overflow:auto;
  animation:pop .28s ease-out;
}
body.dark .modal-inner {
  background:linear-gradient(to bottom,var(--dark-top),var(--dark-bottom));
  color:#eee;
}
@keyframes pop {
  from {transform:scale(.88);opacity:0;}
}

/* SORT BAR */
.sortbar {
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-bottom:20px;
}
.sortbtn {
  padding:6px 10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.25);
  cursor:pointer;
  opacity:.85;
  transition:.25s;
}
.sortbtn:hover {
  background:var(--accent);
  color:white;
  opacity:1;
}
.sortbtn.active {
  background:var(--accent);
  color:white;
}

</style>
</head>

<body>
<header id="hdr">
  <div id="title">I bought the whole domain, I’m going to use the whole domain</div>
  <div id="icons">
    <div class="icon-btn" data-modal="discord"><svg viewBox="0 0 24 24"><path d="M20.317 4.37..."/></svg></div>
    <div class="icon-btn" data-modal="email"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1..."/></svg></div>
    <div class="icon-btn" id="themeToggle"><svg viewBox="0 0 24 24"><path d="M12 3a9..."/></svg></div>
  </div>
</header>

<div class="container">

  <div class="sortbar">
    <div class="sortbtn active" data-sort="date">Newest</div>
    <div class="sortbtn" data-sort="date-old">Oldest</div>
  </div>

  <div id="postsArea">Loading...</div>

</div>

<div class="modal" id="modal">
  <div class="modal-inner" id="modalContent"></div>
</div>

<script>
let allPosts=[];
let pinned=null;

/* FETCH POST TEXT */
async function fetchPost(n){
  try {
    const r=await fetch("./posts/Thing_"+n+".txt",{cache:"no-store"});
    if(!r.ok) return null;
    return await r.text();
  } catch {return null;}
}

/* FETCH IMPORTANT */
async function fetchPinned(){
  try {
    const r=await fetch("./posts/IMPORTANT.txt",{cache:"no-store"});
    if(!r.ok) return null;
    return await r.text();
  } catch {return null;}
}

/* PARSE POST */
function parse(txt){
  if(!txt) return null;
  const lines=txt.trim().split("\n");
  const rawTitle=lines[0];

  // Extract tags
  const tagMatches = rawTitle.match(/\/\#([^\/]+)\//g);
  const tags = tagMatches ? tagMatches.map(x=>x.slice(2,-1)) : [];
  const cleanTitle=rawTitle.replace(/\/\#[^\/]+\//g,"").trim();

  // Extract date
  const dateLine=lines[lines.length-1];
  const dateMatch=dateLine.match(/\/\[(\d{2})\.(\d{2})\.(\d{4})\]\//);
  let date=null;
  if(dateMatch){
    const d=parseInt(dateMatch[1]);
    const m=parseInt(dateMatch[2]);
    const y=parseInt(dateMatch[3]);
    date=new Date(y,m-1,d);
  }

  const content=lines.slice(1,date?lines.length-1:lines.length).join("\n").trim();
  return {title:cleanTitle,tags,content,date,raw:txt};
}

/* SHOW POSTS */
function render(posts){
  const box=document.getElementById("postsArea");
  if(!posts.length){
    box.innerHTML="No posts yet.";
    return;
  }
  box.innerHTML="";
  posts.forEach(p=>{
    const d=document.createElement("div");
    d.className="post";
    d.dataset.date=p.date?p.date.toISOString():"0";
    d.innerHTML=`
      <div class="post-title">${p.title}</div>
      <div>${p.content.replace(/\n/g,"<br>")}</div>
      ${p.tags.length?`<div class="post-tags">${p.tags.map(t=>`<div class="tag">${t}</div>`).join("")}</div>`:""}
      ${p.date?`<div class="date">${formatDate(p.date)}</div>`:""}
    `;
    d.onclick=()=>openModal(p);
    tiltBind(d);
    observer.observe(d);
    box.appendChild(d);
  });
}

/* DATE FORMAT */
function nth(n){return n>3&&n<21?"th":["st","nd","rd"][((n%10)-1)]||"th";}
function formatDate(d){
  return `${d.getDate()}${nth(d.getDate())} May ${d.getFullYear()}`;
}

/* LOAD POSTS */
async function loadPosts(){
  pinned=parse(await fetchPinned());
  if(pinned){
    pinned=parse(pinned);
    pinned.pinned=true;
  }

  let n=1,x;
  while(x=await fetchPost(n)){
    allPosts.push(parse(x));
    n++;
  }
  sortPosts("date");
}
loadPosts();

/* SORTING */
function sortPosts(mode){
  document.querySelectorAll(".sortbtn").forEach(b=>b.classList.remove("active"));
  document.querySelector(`.sortbtn[data-sort="${mode}"]`).classList.add("active");

  let list=[...allPosts];
  list=list.filter(x=>x&&x.title);

  list.sort((a,b)=>{
    if(mode==="date") return (b.date||0)-(a.date||0);
    if(mode==="date-old") return (a.date||0)-(b.date||0);
    return 0;
  });

  if(pinned) list.unshift(pinned);

  render(list);
}
document.querySelectorAll(".sortbtn").forEach(b=>{
  b.onclick=()=>sortPosts(b.dataset.sort);
});

/* TILT */
function tiltBind(el){
  el.addEventListener("mousemove",e=>{
    const r=el.getBoundingClientRect();
    const x=e.clientX-r.left-r.width/2;
    const y=e.clientY-r.top-r.height/2;
    el.style.transform=`rotateX(${(-y/50)}deg) rotateY(${(x/50)}deg) scale(1.02)`;
  });
  el.addEventListener("mouseleave",()=>{
    el.style.transform="";
  });
}

/* REVEAL ON SCROLL */
const observer=new IntersectionObserver(entries=>{
  entries.forEach(a=>{
    if(a.isIntersecting) a.target.classList.add("visible");
    else a.target.classList.remove("visible");
  });
},{threshold:.4});

/* MODAL */
const modal=document.getElementById("modal");
const modalContent=document.getElementById("modalContent");

function openModal(p){
  modalContent.innerHTML=`
    <h2>${p.title}</h2>
    <p>${p.content.replace(/\n/g,"<br>")}</p>
    ${p.date?`<div class="date" style="margin-top:12px;">${formatDate(p.date)}</div>`:""}
  `;
  modal.classList.add("show");
}
modal.onclick=e=>{if(e.target===modal) modal.classList.remove("show");}
document.addEventListener("keydown",e=>{
  if(e.key==="Escape") modal.classList.remove("show");
});

/* TOPBAR COLLAPSE */
let last=0;
window.addEventListener("scroll",()=>{
  const y=window.scrollY;
  if(y>last && y>50) hdr.classList.add("hide-header");
  else hdr.classList.remove("hide-header");
  last=y;
});

/* THEME */
const toggle=document.getElementById("themeToggle");
if(localStorage.theme==="dark") document.body.classList.add("dark");

toggle.onclick=()=>{
  document.body.classList.toggle("dark");
  localStorage.theme=document.body.classList.contains("dark")?"dark":"light";
};

/* POPUPS */
document.querySelectorAll("[data-modal]").forEach(el=>{
  el.onclick=()=>{
    const type=el.dataset.modal;
    let text="";
    if(type==="discord") text="@brousev on Discord";
    if(type==="email") text="contact@rousev.com";
    modalContent.innerHTML=`<h3>${text}</h3>`;
    modal.classList.add("show");
  };
});
</script>
</body>
</html>
